db.pedigrees.aggregate({$project: {uk: "$genogram", genogram: true, status:true}}, {$unwind: "$uk"}, {$match: {"uk.unknown": true}}, {$unwind: "$genogram"}, {$project: {match: {$or: [{$eq: ["$genogram.alias", "$uk.idFather"]}, {$eq: ["$genogram.alias", "$uk.idMother"]}, {$eq: ["$genogram.idFather", "$uk.alias"]}, {$eq: ["$genogram.idMother", "$uk.alias"]}, {$eq: ["$genogram.alias", "$uk.alias"]}]}, genogram: true, status: true, uk: true}}, {$match: {match:true, "genogram.globalCode": {$exists:true}, status: "Active"}}, {$project: {globalCode: "$genogram.globalCode", alias: "$uk.alias"}})
